<launch>
  <!-- ============================================================ -->
  <!-- CLIO AEG ANNOTATION LAUNCH FILE                             -->
  <!-- Includes clio_realsense.launch and adds AEG annotation      -->
  <!-- ============================================================ -->

  <!-- ============================================================ -->
  <!-- AEG ANNOTATION PARAMETERS                                   -->
  <!-- ============================================================ -->
  
  <arg name="llm_model" default="gpt-4o-mini" doc="LLM model to use for annotation"/>
  <arg name="temperature" default="0.8" doc="LLM temperature parameter"/>
  <arg name="annotate_every" default="10" doc="Annotate every N scene graph updates"/>

  <!-- ============================================================ -->
  <!-- PASS-THROUGH PARAMETERS FOR CLIO_REALSENSE                  -->
  <!-- ============================================================ -->
  
  <!-- Camera parameters -->
  <arg name="camera_name" default="camera"/>
  <arg name="serial_no" default="" doc="Camera serial number"/>
  <arg name="device_type" default="" doc="Device type filter (e.g. d435)"/>
  
  <!-- Environment and task configuration -->
  <arg name="environment" default="office" doc="Environment type: office, supermarket, home"/>
  <arg name="object_tasks_file" default="" doc="File to read object tasks from (empty = use environment default)"/>
  <arg name="place_tasks_file" default="" doc="File to read place tasks from (empty = use environment default)"/>

  <!-- ============================================================ -->
  <!-- INCLUDE CLIO + REALSENSE BASE FUNCTIONALITY                 -->
  <!-- ============================================================ -->

  <include file="$(find clio_annotator)/launch/clio_realsense.launch">
    <arg name="camera_name" value="$(arg camera_name)"/>
    <arg name="serial_no" value="$(arg serial_no)"/>
    <arg name="device_type" value="$(arg device_type)"/>
    <arg name="environment" value="$(arg environment)"/>
    <arg name="object_tasks_file" value="$(arg object_tasks_file)"/>
    <arg name="place_tasks_file" value="$(arg place_tasks_file)"/>
  </include>

  <!-- ============================================================ -->
  <!-- AEG ANNOTATION NODE                                          -->
  <!-- ============================================================ -->

  <node pkg="clio_annotator" type="clio_aeg_annotator.py" name="clio_aeg_annotator" output="screen">
    <remap from="~dsg_update" to="/clio_node/backend/dsg"/>
    <remap from="~annotated_dsg_update" to="/annotated_dsg_update"/>
    
    <!-- AEG Parameters -->
    <param name="llm_model" value="$(arg llm_model)"/>
    <param name="temperature" value="$(arg temperature)"/>
    <param name="openai_key" value="$(env OPENAI_API_KEY)"/>
    <param name="annotate_every" value="$(arg annotate_every)"/>
  </node>

</launch>